<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>彻底理解浏览器的缓存机制 | 林河前端之路</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/linhe.jpg">
    <meta name="description" content="前端笔记整理">
    <link rel="preload" href="/assets/css/0.styles.3db95324.css" as="style"><link rel="preload" href="/assets/js/app.fa2fa8e2.js" as="script"><link rel="preload" href="/assets/js/2.86ccc841.js" as="script"><link rel="preload" href="/assets/js/3.e3329f73.js" as="script"><link rel="prefetch" href="/assets/js/10.b1080458.js"><link rel="prefetch" href="/assets/js/11.301336d2.js"><link rel="prefetch" href="/assets/js/12.a0ec66c4.js"><link rel="prefetch" href="/assets/js/13.f0ee8511.js"><link rel="prefetch" href="/assets/js/14.24e34223.js"><link rel="prefetch" href="/assets/js/15.d2ce4b7d.js"><link rel="prefetch" href="/assets/js/16.7e1e6b30.js"><link rel="prefetch" href="/assets/js/17.56c400a4.js"><link rel="prefetch" href="/assets/js/18.07d62660.js"><link rel="prefetch" href="/assets/js/19.9d3c4ce3.js"><link rel="prefetch" href="/assets/js/20.2ae957c4.js"><link rel="prefetch" href="/assets/js/21.92ab6e7e.js"><link rel="prefetch" href="/assets/js/22.f8961621.js"><link rel="prefetch" href="/assets/js/23.2c6ad3f8.js"><link rel="prefetch" href="/assets/js/24.78c37dc8.js"><link rel="prefetch" href="/assets/js/25.12b0e09b.js"><link rel="prefetch" href="/assets/js/26.c6c0c190.js"><link rel="prefetch" href="/assets/js/27.5ba15533.js"><link rel="prefetch" href="/assets/js/28.3be52d52.js"><link rel="prefetch" href="/assets/js/29.9146defa.js"><link rel="prefetch" href="/assets/js/30.c9a80fc0.js"><link rel="prefetch" href="/assets/js/31.b3dab13d.js"><link rel="prefetch" href="/assets/js/32.b2b64554.js"><link rel="prefetch" href="/assets/js/33.8db0bf81.js"><link rel="prefetch" href="/assets/js/34.688002c1.js"><link rel="prefetch" href="/assets/js/35.aa629717.js"><link rel="prefetch" href="/assets/js/36.ebee6c1f.js"><link rel="prefetch" href="/assets/js/37.abd3bf49.js"><link rel="prefetch" href="/assets/js/38.909b7e7c.js"><link rel="prefetch" href="/assets/js/39.c4169ef6.js"><link rel="prefetch" href="/assets/js/4.9e70f2df.js"><link rel="prefetch" href="/assets/js/40.740d29ad.js"><link rel="prefetch" href="/assets/js/5.7f315441.js"><link rel="prefetch" href="/assets/js/6.f567ca52.js"><link rel="prefetch" href="/assets/js/7.a4e4ee7f.js"><link rel="prefetch" href="/assets/js/8.83fdc325.js"><link rel="prefetch" href="/assets/js/9.2cce5191.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3db95324.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/linhe.jpg" alt="林河前端之路" class="logo"> <span class="site-name can-hide">林河前端之路</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/pages/blog/javascript/Webpack配置指南.html" class="nav-link">
  博文
</a></div><div class="nav-item"><a href="/pages/code/一行代码实现时间戳转时分秒.html" class="nav-link">
  代码块
</a></div><div class="nav-item"><a href="https://github.com/aaaxiu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/pages/blog/javascript/Webpack配置指南.html" class="nav-link">
  博文
</a></div><div class="nav-item"><a href="/pages/code/一行代码实现时间戳转时分秒.html" class="nav-link">
  代码块
</a></div><div class="nav-item"><a href="https://github.com/aaaxiu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/blog/javascript/Webpack配置指南.html" class="sidebar-link">Webpack配置指南</a></li><li><a href="/pages/blog/javascript/JavaScript基础.html" class="sidebar-link">JavaScript基础</a></li><li><a href="/pages/blog/javascript/前端实现图片压缩上传.html" class="sidebar-link">前端实现图片压缩上传</a></li><li><a href="/pages/blog/javascript/数组去重方式.html" class="sidebar-link">数组去重方式</a></li><li><a href="/pages/blog/javascript/encodeURI和encodeURIComponent.html" class="sidebar-link">encodeURI和encodeURIComponent</a></li><li><a href="/pages/blog/javascript/原型和原型链.html" class="sidebar-link">原型和原型链</a></li><li><a href="/pages/blog/javascript/防抖和节流.html" class="sidebar-link">防抖和节流</a></li><li><a href="/pages/blog/javascript/函数柯里化.html" class="sidebar-link">函数柯里化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/blog/css/Css基础.html" class="sidebar-link">Css基础</a></li><li><a href="/pages/blog/css/Css3和Html5新特性不完全手册.html" class="sidebar-link">Css3和Html5新特性不完全手册</a></li><li><a href="/pages/blog/css/Css3伪类.html" class="sidebar-link">Css3伪类</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/blog/vue/Vue项目性能优化.html" class="sidebar-link">Vue项目性能优化</a></li><li><a href="/pages/blog/vue/Vue_history模式配置.html" class="sidebar-link">Vue_history模式配置</a></li><li><a href="/pages/blog/vue/Vue实战项目总结.html" class="sidebar-link">Vue实战项目总结</a></li><li><a href="/pages/blog/vue/Element远程搜索Bug.html" class="sidebar-link">Element远程搜索Bug</a></li><li><a href="/pages/blog/vue/Vue面试题汇总.html" class="sidebar-link">Vue面试题汇总</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Git</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/blog/git/Git常用命令.html" class="sidebar-link">Git常用命令</a></li><li><a href="/pages/blog/git/Git配置和错误.html" class="sidebar-link">Git配置和错误</a></li><li><a href="/pages/blog/git/Git生成多个公钥.html" class="sidebar-link">Git生成多个公钥</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Others</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/blog/others/跨域解决方案.html" class="sidebar-link">跨域解决方案</a></li><li><a href="/pages/blog/others/一道算法题.html" class="sidebar-link">一道算法题</a></li><li><a href="/pages/blog/others/VSCode插件和配置.html" class="sidebar-link">VSCode插件和配置</a></li><li><a href="/pages/blog/others/彻底理解浏览器的缓存机制.html" class="active sidebar-link">彻底理解浏览器的缓存机制</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/blog/others/在第三方页面调用微信接口.html" class="sidebar-link">在第三方页面调用微信接口</a></li><li><a href="/pages/blog/others/移动端遮罩阻止滚动方案.html" class="sidebar-link">移动端遮罩阻止滚动方案</a></li><li><a href="/pages/blog/others/Content-type的几种常见类型.html" class="sidebar-link">Content-type的几种常见类型</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="彻底理解浏览器的缓存机制"><a href="#彻底理解浏览器的缓存机制" class="header-anchor">#</a> 彻底理解浏览器的缓存机制</h1> <br> <blockquote><p>本文转载自： https://heyingye.github.io/2018/04/16/彻底理解浏览器的缓存机制, 个人觉得讲解得很详细很透彻,经博主同意转载分享给大家。</p></blockquote> <p>补充一张神图：</p> <p><img src="/assets/img/1652ce6490fcfb58.de06a3f0.png" alt=""></p> <h3 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h3> <p>浏览器的缓存机制也就是我们说的HTTP缓存机制，其机制是根据HTTP报文的缓存标识进行的，所以在分析浏览器缓存机制之前，我们先使用图文简单介绍一下HTTP报文，HTTP报文分为两种：</p> <ul><li>HTTP请求(Request)报文，报文格式为：请求行 – HTTP头(通用信息头，请求头，实体头) – 请求报文主体(只有<code>POST</code>才有报文主体)，如下图</li></ul> <p><img src="/assets/img/8.f7fb9c88.png" alt=""></p> <p><img src="data:image/png;base64,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" alt=""></p> <ul><li>HTTP响应(Response)报文，报文格式为：状态行 – HTTP头(通用信息头，响应头，实体头) – 响应报文主体，如下图</li></ul> <p><img src="/assets/img/10.e3d4c5bc.png" alt=""></p> <p><img src="data:image/png;base64,UklGRnAOAABXRUJQVlA4IGQOAAAwSACdASqFAigAPpE+mkglo6KhJ9M+GLASCWgAzQkjtau7J/MP2k6EPgEx6hAf5DdFfst6gP2M/Un3af8/+jvuU/xe+QfsR7AH6n+lz+yXwPf2b/P/tZ7Tf/31p3y9/Ue0j+++HPhW9le33rQfwHkW598UX2G/W/2v0K/0/hL8AdQL03/nPDd2tVg/QC9dPkX+p+3Xz+P4D7D/gD6c/6r3AP5L/Of+F6Yf8jwi/oPqAfy3+yf77+/f339ifpM/e//L/hPy19nH5j/iv/f/ofgG/lP9O/5v+H9rv2HfuP7NH7DiCqOU8ER96Tf2MXOy0CKw+WBvINqW6CkhcZFNYS+6bMRsI7p5aBd2YkDLs7LyCxKsD8zG1d0AIWerkC8FZUnbSTMaqNtl91/RG0sbDGmJgV39gag4+D0I694A5bzNMDjGAmxb5E8vEiGA6ZT7G9vxfM6XLa9o4hsk13lNJ1KH1cKjCjUPOcrxBS+r0ZnmD5V5IURmJvbV38mXa4y1ptniSJRblZXrNhBU+tbLXvlMaunoJTxww7nTcNBuwqZb9ig/ldU1GEj2NqJFrXMlE5Pz0n8MriZgtw7eWZmHuR3cZTpRYUcsfkiosCY909UMebnHx+v/Imf5NH7lIzuNsCT7rwoceAkvX7Q0ex+IpMCR6u66lIzq5YD/pX/Ln54tMUB8gThGTV3VT6kOxPCn/2NkRxCwUC6aVTaDQgJQdoOM2k/lwUMKQ2wNaGuES1eoHbYUS1eoHbYUS1pwHbcC3WFGh0x02gJ0TTUAAP7a//zeftUCtdbkRpKwf8IYLQKAZL6LQPHS3oJDjyY52orYadfFCg5+9fL19Hxu9KZx9jFg19WkzwS+76b1GHQkjEV9zJb/YlDwQjL/T0tEclBnnK5HLCzYhBVu6HUJunZvB07D6d2xyHU3E4aEo/z97tVdgmy9zB2CPJOViOHLh5sUALB6kDNW265ydN+HKfkd7liaM0Sm1nzRSJ7kMLWH5W9bd5tGrxcpm9mFfBuWpf44qGSEj3JmrpdGUGF9OtjxleJb9hVjav4QWUH66ltKddN8Fbc4evGvUz8cHKf/eNNtjnMM7BtRHF253+1yP5Wg4yxGAnlC9Q5rZVpNR0XOx55qxcmJ92W7MYWcTrsXniYoJ7X3sgd32qaEcSXtNBZwccLJ5myCj4A85zcL6ajW/X7plhdd0BL27Qv0Q5p5C7LMdaPEnbNWN/JM2XeMEm7e90VXzGkRbxgToixAQJPgZ5VhBd5q3TYQ5s+1+K09/SUYOSGHsSQN5B+FYtwTK51vj72Gtaax1fbqLYP9bsr++a7Wi7ar3P4T/09NO+9PGoIJ79SJr1P4M5GyZCCxXu/n9yZrK7zl11nzjExyWpAlyWFliD+b/hJuf8F7pHvdff0lb+XYVmlW+oH+1z1L6Wh5Lsku31svKwpCqfamlwBE1VRFpx2lMOgs/5dtCp4mDmvgm2YzNEa5O7FT3IKo3gRZtRPEVvQaY/EqxJtyO20bfsH5EKUuJ4Hoi7BZZTl4zdpgKQB9tN7FzcBzZ5/bOTGYp0NyP3VAFlFqiplV73jukYreXBf6bXyfdpSat/TmuNY6VEUbVhWv+nZXglf8m5higocFh99DxtmcKXFykEI6y/LXD4mVHhfySp8WNEPVkmdneRTMq0pyuf09NPSnbC5Xd77+VL/5mZHNmlSdreM3ibfptqV6oQki/pMSIxUPYYM+dUbaUhr43D37jjTQnXwnpo/J/VjpjA9InmWG2LH8u9pggeO8DwneRbEWs6ctZjO/k/ViNZIyLWsbGSzXx289NdUtDm9unuCx7q7MWfLrpPbws+QNg8aaFacXu8yL6CKxjqDBKTFrYBldUbnKAcEHlm66svxbxvPFmliV3FEpv/75vXkemau8uP+/KutkFclSfKdSNoQtR1+17y0wG78bm3dSQl0Q6qiGw5yWJtjt3VTEMMbzIJw9Xj0UBA+l3GYhwHK3dd1LZbXzsvljfGAK7OB9umUEUlAFS7Pzt9egD8WdgbGbadnctej2bwsiHMmvj8g0dcVOtlxpNSwounrWb8AQwCnKPIU6OCSOR63LkFcbF14irxQ9THL2PWvfmbK/TJ88BfHXO5JuMmp+0xYs9RWYTg+SQ+t6LJQca1CEV0GckXB8j55uaidkFSNgMIf+INrHaYBsp1TLX68FkzAFVeLC/lVMkEyi+oADCXvlqY7gK6Hsf3qqzCBK+tXlq7bXYhyC+Mzz8qm/y9LdNJEFyyvrAnN6YwF9CyHBa+MdJ+zfJcme4XpQcbigDfdQKD5SzvdP4ctzRM7p1LQTBfz/babGe79CUgtClP6x9znkRNUzgkxbtMPVD7Xg2EFKtQCtg8ZtFdEr972kFieLdcoVwVm3t/9vYtxvRDwpEzLMB7Q5CszAnXRcsG3m68oz/fB2l3EmDl0NGDYJZUtdfrWEh//bdzPuXRhevbFC9AyfzDdr8DWgWpjP7aka0lhBnMOzCo1FAUWjTvH85RQ+p7i4cQr+TBW8br4OY4VE7G0KxRY/apa4RQ4rSnTBRcCxpb45Ev2gSSXHBMfPhGFg3RF1OfgPa3WxA5q6+W/nrztVRmxEHiroEBtE4cjGX9tceoW/46FOXH6b7bjxp248INPhf3g2UTZcHPL3GYiuM9OMfVHYPw/+yJjtb+PrGuvBt9dE5tAezbBRQfbMe8uoN9N809QavDuYWKuuo8Uzl2rZclF/v3GaeLhQfi4yJhCHtGav+q+1Kg4xKJaMS7KnUILS0/lRPUoG1IfU2m7Jmw9f4o5Kk1CoZIWcb/NiLAMrgPTf/oLszaYm0WZGvajplYAbgyHdUFt7RcX4NFgC4l5K0ELHi9kQPDtuiSdXM2dzBVJviojo1BikH1YpInf1wpECMJP/Pi06uVxc95NqeCP4ZhB9fYl8fyfVW4RMNUqcFXVNuJCNAdp2fJ0rl0iZhPX5CJXrCQvxGX/8IkXlDSb42xn2D2FdNWrivA7F2uwbWX4cCyr+FjU+QW8qoLzw575W+4nS7Pi8FmkBZpMeNtTnSOPvq3XchffcajyrhJJVbo/0ZzfFtBq4YKqFVzYCKfWAMZuWR14Hc12zTLVs3IubBcqOtMlmI9UK2kxetZhfrL53dtUgrjE88zj+/1yD6ghOhkNhpS/9nymefPUaiZ9eS0ABw0rp2Q0tsOK3xJii+ijiL/r+/UKzXLPlds3XRcglGnAzwxMAr4tDPO6l5Hvf5J22I/NDApI597lVkhjxAwec00B7Ofdz4azLhhTviLVKAfnu2+ITALLv3TIbP2+6u2nQ1ewaB9HXzxlYtsoYxFR3cjkREbFQfDoM1GkbS3q/uaA5HsQXHYeCqBMmxqnqSLhYRCQ8ew5/z/lmm867nuts0rjuhyE98x2TRs6wmXTM0onoM4WOZsezGQP/ZKEJP1sbte2R66MIIcO7TLaIaB6NxVe49vT8N1Z36p+/08m1erYcpTM2a95WmUUIxstmLG3ALTHxgYsaSg427YQ/baQNic3TwQQOoFyD0Z8eqIBA3rZb+cZ3Vz2i951iGTKepJL8PDIjF+NPi9DVA6gugdsgDQrt9cPwiPsxFoNHxb2j+cfLg0UgltSAtP1Xjg9YsHPpv1JKl2SlPFwLBMT5J0Cl1YaQeHYe08uKNQJooM5ZfsDNZZpB7nLYt5q5r4hy/mGyyRDvnuniCTTTSycPCvQdOAUXtvyFZVCBm47tPCP8GUVehHRdDD0s6XE2rYXxSzImhdJxF8javDIYmdyAjT+YIQDUhUSF8wibmjPhpgp9vy/heHkWIAB5GQGJXpCu0SFDujGjWi9IFb1r9SKBvuPiA0H0dicdGfbyAXjhDIostm2ecT+pGz68zW98N0KwFVhq5VwfGAYCJXcSVka0z9XT5icw3PxOVI5PzeWRC06hrcbCs6ix2B+1b6Y3qsEVWSfn0rB8wvcEzkF3FzAi2nNyEJtSn9K+6hnDkdOkMfwbdN3Ief04O3a8/vmf+sj9wKQQqO5Ns2bV33LABoTbthYIB14xuqwK2zD2HoXxu4586wLoMC1hl/1CxC4/n3BKHc+0y2IsUkuUPNzPjNAjxezpIyDIWhPYZbVEbd0/ndpdmvOU4JLKWuIKz6DhcWvsmyiCH7xRm7OtC1ktTzZLOEXagIPp+PMXptgRw2QB0BwUDH0zixSyhmbGFoBQBEGAYEzLXeB1HSGq2BQClVEnXke9qfahQCj7AKfDQ0I50gzOcFbLcjGNWU+U4bH/L8kJMXTgJdGrBoTN7fdvmKJUH7GWkhGoxSQ3zIGMR3h3c5uC6X8lFwf93ZC/UG4eZ6dcsV66uAUOaRpPzCk78uu4Rx6eEZG0KqZzrBkq12C1aNlJbf8pndZ908Vkocnfwcj97KtH8rGwLOqo6rJF+0UdT3+Gxc1dIGV+Ba80c5JUBUNaPq/uCOigcbxBBIAZXBAOpf6XYe7EVLCsxwCZLvOC3Xo1N7BytyUN+rfNItlPBfMszpvANuSNw/nl3glV5GEU5a5OyuKWSHHVZT2d5G3XnsE9n2UOyebID2750xF9TR3WXmrnFwa21DkEhw1g1nEf+MXrEOH4gjLmva4lccBt3fobvZVrUkfDxxxugaDL1m4l+PtDMbPsGmKnwj3pd0i40AeZjj6BJTBDPLH5BvXequom1h/TZPyj7a48za4h39Z9ueGZcBLRcVltj+Kw+hpeHEX0H91NQln+WU6oZIq+ZqiGggKz2X0QJCU24Upk1stoX2DyiyeM69EsxdP64NOn1RS3AjKNCJ8n/eUU1DrVzwPUKHfW/D1oOuhs8Ib49KvZVYz0c66/TSlUyEuWOi0jgAgiov6dZ1WfLoCZUCRQ24D/SLatyhVuK8rF68QQG3MWbNSrXMTye4AAOhAaSAG2tAGHneRrEgA=" alt=""></p> <blockquote><p>注：通用信息头指的是请求和响应报文都支持的头域，分别为<code>Cache-Control</code>、<code>Connection</code>、<code>Date</code>、<code>Pragma</code>、<code>Transfer-Encoding</code>、<code>Upgrade</code>、<code>Via</code>；实体头则是实体信息的实体头域，分别为<code>Allow</code>、<code>Content-Base</code>、<code>Content-Encoding</code>、<code>Content-Language</code>、<code>Content-Length</code>、<code>Content-Location</code>、<code>Content-MD5</code>、<code>Content-Range</code>、<code>Content-Type</code>、<code>Etag</code>、<code>Expires</code>、<code>Last-Modified</code>、<code>extension-header</code>。这里只是为了方便理解，将通用信息头，响应头/请求头，实体头都归为了HTTP头。</p></blockquote> <p>以上的概念在这里我们不做多讲解，只简单介绍，有兴趣的童鞋可以自行研究。</p> <h3 id="缓存过程分析"><a href="#缓存过程分析" class="header-anchor">#</a> 缓存过程分析</h3> <p>浏览器与服务器通信的方式为应答模式，即是：浏览器发起HTTP请求 – 服务器响应该请求。那么浏览器第一次向服务器发起该请求后拿到请求结果，会根据响应报文中HTTP头的缓存标识，决定是否缓存结果，是则将请求结果和缓存标识存入浏览器缓存中，简单的过程如下图：</p> <p><img src="/assets/img/12.275c298a.png" alt=""></p> <p>由上图我们可以知道：</p> <ul><li>浏览器每次发起请求，都会先在浏览器缓存中查找该请求的结果以及缓存标识</li> <li>浏览器每次拿到返回的请求结果都会将该结果和缓存标识存入浏览器缓存中</li></ul> <p>以上两点结论就是浏览器缓存机制的关键，他确保了每个请求的缓存存入与读取，只要我们再理解浏览器缓存的使用规则，那么所有的问题就迎刃而解了，本文也将围绕着这点进行详细分析。为了方便大家理解，这里我们根据是否需要向服务器重新发起HTTP请求将缓存过程分为两个部分，分别是<strong>强制缓存</strong>和<strong>协商缓存</strong> 。</p> <h3 id="强制缓存"><a href="#强制缓存" class="header-anchor">#</a> 强制缓存</h3> <p>强制缓存就是向浏览器缓存查找该请求结果，并根据该结果的缓存规则来决定是否使用该缓存结果的过程，强制缓存的情况主要有三种(暂不分析协商缓存过程)，如下：</p> <ul><li>不存在该缓存结果和缓存标识，强制缓存失效，则直接向服务器发起请求（跟第一次发起请求一致），如下图：</li></ul> <p><img src="/assets/img/13.1a653253.png" alt=""></p> <ul><li>存在该缓存结果和缓存标识，但该结果已失效，强制缓存失效，则使用协商缓存(暂不分析)，如下图</li></ul> <p><img src="/assets/img/14.8b3ffdc0.png" alt=""></p> <ul><li>存在该缓存结果和缓存标识，且该结果尚未失效，强制缓存生效，直接返回该结果，如下图</li></ul> <p><img src="/assets/img/15.e32b0bf9.png" alt=""></p> <blockquote><p>那么强制缓存的缓存规则是什么？</p></blockquote> <p>当浏览器向服务器发起请求时，服务器会将缓存规则放入HTTP响应报文的HTTP头中和请求结果一起返回给浏览器，控制强制缓存的字段分别是<code>Expires</code>和<code>Cache-Control</code>，其中<code>Cache-Control</code>优先级比<code>Expires</code>高。</p> <h4 id="expires"><a href="#expires" class="header-anchor">#</a> Expires</h4> <p><code>Expires</code>是HTTP/1.0控制网页缓存的字段，其值为服务器返回该请求结果缓存的到期时间，即再次发起该请求时，如果客户端的时间小于<code>Expires</code>的值时，直接使用缓存结果。</p> <blockquote><p><code>Expires</code>是HTTP/1.0的字段，但是现在浏览器默认使用的是HTTP/1.1，那么在HTTP/1.1中网页缓存还是否由<code>Expires</code>控制？</p></blockquote> <p>到了HTTP/1.1，Expire已经被<code>Cache-Control</code>替代，原因在于<code>Expires</code>控制缓存的原理是使用客户端的时间与服务端返回的时间做对比，那么如果客户端与服务端的时间因为某些原因（例如时区不同；客户端和服务端有一方的时间不准确）发生误差，那么强制缓存则会直接失效，这样的话强制缓存的存在则毫无意义，那么<code>Cache-Control</code>又是如何控制的呢？</p> <h4 id="cache-control"><a href="#cache-control" class="header-anchor">#</a> Cache-Control</h4> <p>在HTTP/1.1中，<code>Cache-Control</code>是最重要的规则，主要用于控制网页缓存，主要取值为：</p> <ul><li><code>public</code>：所有内容都将被缓存（客户端和代理服务器都可缓存）</li> <li><code>private</code>：所有内容只有客户端可以缓存，<code>Cache-Control</code>的默认取值</li> <li><code>no-cache</code>：客户端缓存内容，但是是否使用缓存则需要经过协商缓存来验证决定</li> <li><code>no-store</code>：所有内容都不会被缓存，即不使用强制缓存，也不使用协商缓存</li> <li><code>max-age=xxx (xxx is numeric)</code>：缓存内容将在xxx秒后失效
接下来，我们直接看一个例子，如下：</li></ul> <p><img src="/assets/img/16.282f48ee.png" alt=""></p> <p>由上面的例子我们可以知道：</p> <ul><li>HTTP响应报文中<code>expires</code>的时间值，是一个绝对值</li> <li>HTTP响应报文中<code>Cache-Control</code>为max-age=600，是相对值
由于<code>Cache-Control</code>的优先级比<code>expires</code>高，那么直接根据<code>Cache-Control</code>的值进行缓存，意思就是说在600秒内再次发起该请求，则会直接使用缓存结果，强制缓存生效。</li></ul> <blockquote><p>注：在无法确定客户端的时间是否与服务端的时间同步的情况下，<code>Cache-Control</code>相比于<code>expires</code>是更好的选择，所以同时存在时，只有<code>Cache-Control</code>生效。</p></blockquote> <p>了解强制缓存的过程后，我们拓展性的思考一下：</p> <blockquote><p>浏览器的缓存存放在哪里，如何在浏览器中判断强制缓存是否生效？</p></blockquote> <p><img src="/assets/img/17.0dbb0b82.png" alt=""></p> <p>这里我们以博客的请求为例，状态码为灰色的请求则代表使用了强制缓存，请求对应的Size值则代表该缓存存放的位置，分别为from memory cache 和 from disk cache。</p> <blockquote><p>那么from memory cache 和 from disk cache又分别代表的是什么呢？什么时候会使用from disk cache，什么时候会使用from memory cache呢？</p></blockquote> <p>from memory cache代表使用内存中的缓存，from disk cache则代表使用的是硬盘中的缓存，浏览器读取缓存的顺序为memory –&gt; disk。
虽然我已经直接把结论说出来了，但是相信有不少人对此不能理解，那么接下来我们一起详细分析一下缓存读取问题，这里仍让以我的博客为例进行分析：
访问https://heyingye.github.io/ –&gt; 200 –&gt; 关闭博客的标签页 –&gt; 重新打开https://heyingye.github.io/ –&gt; 200(from disk cache) –&gt; 刷新 –&gt; 200(from memory cache)
过程如下：</p> <ul><li>访问https://heyingye.github.io/</li></ul> <p><img src="/assets/img/18.e8d5cfef.png" alt=""></p> <ul><li>关闭博客的标签页</li> <li>重新打开https://heyingye.github.io/</li></ul> <p><img src="/assets/img/19.094beca5.png" alt=""></p> <ul><li>刷新</li></ul> <p><img src="/assets/img/20.107be1ab.png" alt=""></p> <blockquote><p>看到这里可能有人小伙伴问了，最后一个步骤刷新的时候，不是同时存在着from disk cache和from memory cache吗？</p></blockquote> <p>对于这个问题，我们需要了解内存缓存(from memory cache)和硬盘缓存(from disk cache)，如下:</p> <ul><li>内存缓存(from memory cache)：内存缓存具有两个特点，分别是快速读取和时效性：
<ul><li>快速读取：内存缓存会将编译解析后的文件，直接存入该进程的内存中，占据该进程一定的内存资源，以方便下次运行使用时的快速读取。</li> <li>时效性：一旦该进程关闭，则该进程的内存则会清空。</li></ul></li> <li>硬盘缓存(from disk cache)：硬盘缓存则是直接将缓存写入硬盘文件中，读取缓存需要对该缓存存放的硬盘文件进行I/O操作，然后重新解析该缓存内容，读取复杂，速度比内存缓存慢。
在浏览器中，浏览器会在js和图片等文件解析执行后直接存入内存缓存中，那么当刷新页面时只需直接从内存缓存中读取(from memory cache)；而css文件则会存入硬盘文件中，所以每次渲染页面都需要从硬盘读取缓存(from disk cache)。</li></ul> <h3 id="协商缓存"><a href="#协商缓存" class="header-anchor">#</a> 协商缓存</h3> <p>协商缓存就是强制缓存失效后，浏览器携带缓存标识向服务器发起请求，由服务器根据缓存标识决定是否使用缓存的过程，主要有以下两种情况：</p> <ul><li>协商缓存生效，返回304，如下</li></ul> <p><img src="/assets/img/21.7c83a0e3.png" alt=""></p> <ul><li>协商缓存失效，返回200和请求结果结果，如下</li></ul> <p><img src="/assets/img/22.b1746736.png" alt=""></p> <p>同样，协商缓存的标识也是在响应报文的HTTP头中和请求结果一起返回给浏览器的，控制协商缓存的字段分别有：<code>Last-Modified / If-Modified-Since</code>和<code>Etag / If-None-Match</code>，其中<code>Etag / If-None-Match</code>的优先级比<code>Last-Modified / If-Modified-Since</code>高。</p> <h4 id="last-modified-if-modified-since"><a href="#last-modified-if-modified-since" class="header-anchor">#</a> Last-Modified / If-Modified-Since</h4> <ul><li><code>Last-Modified</code>是服务器响应请求时，返回该资源文件在服务器最后被修改的时间，如下。</li></ul> <p><img src="/assets/img/23.75a36c8c.png" alt=""></p> <ul><li><code>If-Modified-Since</code>则是客户端再次发起该请求时，携带上次请求返回的<code>Last-Modified</code>值，通过此字段值告诉服务器该资源上次请求返回的最后被修改时间。服务器收到该请求，发现请求头含有<code>If-Modified-Since</code>字段，则会根据<code>If-Modified-Since</code>的字段值与该资源在服务器的最后被修改时间做对比，若服务器的资源最后被修改时间大于<code>If-Modified-Since</code>的字段值，则重新返回资源，状态码为200；否则则返回304，代表资源无更新，可继续使用缓存文件，如下。</li></ul> <p><img src="/assets/img/24.4c5175e7.png" alt=""></p> <h4 id="etag-if-none-match"><a href="#etag-if-none-match" class="header-anchor">#</a> Etag / If-None-Match</h4> <ul><li><code>Etag</code>是服务器响应请求时，返回当前资源文件的一个唯一标识(由服务器生成)，如下。</li></ul> <p><img src="/assets/img/25.c59fe4a9.png" alt=""></p> <ul><li><code>If-None-Match</code>是客户端再次发起该请求时，携带上次请求返回的唯一标识<code>Etag</code>值，通过此字段值告诉服务器该资源上次请求返回的唯一标识值。服务器收到该请求后，发现该请求头中含有<code>If-None-Match</code>，则会根据<code>If-None-Match</code>的字段值与该资源在服务器的<code>Etag</code>值做对比，一致则返回304，代表资源无更新，继续使用缓存文件；不一致则重新返回资源文件，状态码为200，如下。</li></ul> <p><img src="/assets/img/26.11aacd87.png" alt=""></p> <blockquote><p>注：<code>Etag / If-None-Match</code>优先级高于<code>Last-Modified / If-Modified-Since</code>，同时存在则只有<code>Etag / If-None-Match</code>生效。</p></blockquote> <h1 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h1> <p>强制缓存优先于协商缓存进行，若强制缓存(<code>Expires</code>和<code>Cache-Control</code>)生效则直接使用缓存，若不生效则进行协商缓存(<code>Last-Modified / If-Modified-Since</code>和<code>Etag / If-None-Match</code>)，协商缓存由服务器决定是否使用缓存，若协商缓存失效，那么代表该请求的缓存失效，重新获取请求结果，再存入浏览器缓存中；生效则返回304，继续使用缓存，主要过程如下：</p> <p><img src="/assets/img/27.b58f10af.png" alt=""></p> <!----></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/pages/blog/others/VSCode插件和配置.html" class="prev">
        VSCode插件和配置
      </a></span> <span class="next"><a href="/pages/blog/others/在第三方页面调用微信接口.html">
        在第三方页面调用微信接口
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.fa2fa8e2.js" defer></script><script src="/assets/js/2.86ccc841.js" defer></script><script src="/assets/js/3.e3329f73.js" defer></script>
  </body>
</html>
