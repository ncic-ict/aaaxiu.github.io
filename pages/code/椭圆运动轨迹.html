<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>椭圆运动轨迹 | 林河前端之路</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/linhe.jpg">
    <meta name="description" content="前端笔记整理">
    <link rel="preload" href="/assets/css/0.styles.3db95324.css" as="style"><link rel="preload" href="/assets/js/app.fa2fa8e2.js" as="script"><link rel="preload" href="/assets/js/2.86ccc841.js" as="script"><link rel="preload" href="/assets/js/36.ebee6c1f.js" as="script"><link rel="prefetch" href="/assets/js/10.b1080458.js"><link rel="prefetch" href="/assets/js/11.301336d2.js"><link rel="prefetch" href="/assets/js/12.a0ec66c4.js"><link rel="prefetch" href="/assets/js/13.f0ee8511.js"><link rel="prefetch" href="/assets/js/14.24e34223.js"><link rel="prefetch" href="/assets/js/15.d2ce4b7d.js"><link rel="prefetch" href="/assets/js/16.7e1e6b30.js"><link rel="prefetch" href="/assets/js/17.56c400a4.js"><link rel="prefetch" href="/assets/js/18.07d62660.js"><link rel="prefetch" href="/assets/js/19.9d3c4ce3.js"><link rel="prefetch" href="/assets/js/20.2ae957c4.js"><link rel="prefetch" href="/assets/js/21.92ab6e7e.js"><link rel="prefetch" href="/assets/js/22.f8961621.js"><link rel="prefetch" href="/assets/js/23.2c6ad3f8.js"><link rel="prefetch" href="/assets/js/24.78c37dc8.js"><link rel="prefetch" href="/assets/js/25.12b0e09b.js"><link rel="prefetch" href="/assets/js/26.c6c0c190.js"><link rel="prefetch" href="/assets/js/27.5ba15533.js"><link rel="prefetch" href="/assets/js/28.3be52d52.js"><link rel="prefetch" href="/assets/js/29.9146defa.js"><link rel="prefetch" href="/assets/js/3.e3329f73.js"><link rel="prefetch" href="/assets/js/30.c9a80fc0.js"><link rel="prefetch" href="/assets/js/31.b3dab13d.js"><link rel="prefetch" href="/assets/js/32.b2b64554.js"><link rel="prefetch" href="/assets/js/33.8db0bf81.js"><link rel="prefetch" href="/assets/js/34.688002c1.js"><link rel="prefetch" href="/assets/js/35.aa629717.js"><link rel="prefetch" href="/assets/js/37.abd3bf49.js"><link rel="prefetch" href="/assets/js/38.909b7e7c.js"><link rel="prefetch" href="/assets/js/39.c4169ef6.js"><link rel="prefetch" href="/assets/js/4.9e70f2df.js"><link rel="prefetch" href="/assets/js/40.740d29ad.js"><link rel="prefetch" href="/assets/js/5.7f315441.js"><link rel="prefetch" href="/assets/js/6.f567ca52.js"><link rel="prefetch" href="/assets/js/7.a4e4ee7f.js"><link rel="prefetch" href="/assets/js/8.83fdc325.js"><link rel="prefetch" href="/assets/js/9.2cce5191.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3db95324.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/linhe.jpg" alt="林河前端之路" class="logo"> <span class="site-name can-hide">林河前端之路</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/pages/blog/javascript/Webpack配置指南.html" class="nav-link">
  博文
</a></div><div class="nav-item"><a href="/pages/code/一行代码实现时间戳转时分秒.html" class="nav-link">
  代码块
</a></div><div class="nav-item"><a href="https://github.com/aaaxiu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/pages/blog/javascript/Webpack配置指南.html" class="nav-link">
  博文
</a></div><div class="nav-item"><a href="/pages/code/一行代码实现时间戳转时分秒.html" class="nav-link">
  代码块
</a></div><div class="nav-item"><a href="https://github.com/aaaxiu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>代码块</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/code/一行代码实现时间戳转时分秒.html" class="sidebar-link">一行代码实现时间戳转时分秒</a></li><li><a href="/pages/code/饿了么Dialog组件二次封装.html" class="sidebar-link">饿了么Dialog组件二次封装</a></li><li><a href="/pages/code/椭圆运动轨迹.html" class="active sidebar-link">椭圆运动轨迹</a></li><li><a href="/pages/code/常用scss函数表.html" class="sidebar-link">常用scss函数表</a></li><li><a href="/pages/code/公共方法汇总.html" class="sidebar-link">公共方法汇总</a></li><li><a href="/pages/code/浮点数运算误差.html" class="sidebar-link">浮点数运算误差</a></li><li><a href="/pages/code/isEqual.html" class="sidebar-link">isEqual</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="椭圆运动轨迹"><a href="#椭圆运动轨迹" class="header-anchor">#</a> 椭圆运动轨迹</h1> <br> <blockquote><p>关于活动的一个需求，设置6个球不一样大小，点击按钮开始进行椭圆形轨迹旋转，获取到后台数据后缓慢停留在最近一个匹配颜色的球上。效果图 <a href="https://codepen.io/linhe009/pen/oNjRWXa" target="_blank" rel="noopener noreferrer">地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <ul><li>HTML</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ball-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ball-layout<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>open-team<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>选择战队<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>CSS</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">html, body</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.ball-container</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 4.12rem<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 3.6rem<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> .34rem auto 0<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>  
<span class="token selector">.ball-container .ball-layout</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span> <span class="token function">rotate</span><span class="token punctuation">(</span>-90deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.ball-container .ball-layout div</span> <span class="token punctuation">{</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> .72rem<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> .72rem<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> yellow no-repeat center/100% 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.ball-container .ball-layout div:nth-of-type(2n)</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> red no-repeat center/100% 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>JS</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取元素样式函数</span>
  <span class="token keyword">function</span> <span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span>name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>getComputedStyle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> window<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> el<span class="token punctuation">.</span>currentStyle<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 设置初始值</span>
  <span class="token keyword">const</span> path_length <span class="token operator">=</span> <span class="token number">60</span> <span class="token comment">// 定义路径的半长轴的长度</span>
  <span class="token keyword">const</span> path_width <span class="token operator">=</span> <span class="token number">80</span> <span class="token comment">// 定义路径的半短轴的长度</span>
  <span class="token keyword">const</span> wh_increase_var <span class="token operator">=</span> <span class="token number">13</span> <span class="token comment">// 小球样式切换变量</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">// 定时器id</span>
  <span class="token keyword">let</span> path_angel <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// 初始化角度为0</span>
  <span class="token keyword">let</span> ballWidth <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// 球的原始宽度</span>
  <span class="token keyword">let</span> ballHeight <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// 球的原始高度</span>
  <span class="token keyword">let</span> throttle <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment">// 节流阀</span>
  <span class="token keyword">let</span> angel_increase <span class="token operator">=</span> <span class="token number">7</span> <span class="token comment">// 小球运动角度增量</span>
  <span class="token keyword">let</span> team <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">// 模拟战队 0-红队 1-黄队 2-没有选择</span>

  <span class="token comment">// 获取基本dom</span>
  <span class="token keyword">const</span> DOpenTeam <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.open-team'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> dBallLayout <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.ball-layout'</span><span class="token punctuation">)</span>

  <span class="token comment">// 创建小球</span>
  <span class="token keyword">const</span> balls <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ball <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
    balls<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>ball<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  dBallLayout<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>balls<span class="token punctuation">)</span>

  <span class="token comment">// 初始化球的位置和样式</span>
  ballWidth <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">getStyle</span><span class="token punctuation">(</span>dBallLayout<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'width'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  ballHeight <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">getStyle</span><span class="token punctuation">(</span>dBallLayout<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'height'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  dBallLayout<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> path_length <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">'rem'</span>
  dBallLayout<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> path_width <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">'rem'</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dBallLayout<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ballItem <span class="token operator">=</span> dBallLayout<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token comment">//转化角度为弧度制</span>
    <span class="token keyword">const</span> angel <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>path_angel <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span>
    ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token punctuation">(</span>path_length <span class="token operator">*</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>angel<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">&quot;rem&quot;</span>
    ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token punctuation">(</span>path_width <span class="token operator">*</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>angel<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">&quot;rem&quot;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> angel <span class="token operator">&lt;=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ballItem.style.width = ballWidth + (angel * wh_increase_var) / 50 + 'rem'</span>
      <span class="token comment">// 原始设置宽高方法球的空间感不强，替换成下面的写法</span>
      ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token punctuation">(</span>ballWidth <span class="token operator">+</span> <span class="token punctuation">(</span>angel <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>angel <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> wh_increase_var<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">'rem'</span>
      ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token punctuation">(</span>ballHeight <span class="token operator">+</span> <span class="token punctuation">(</span>angel <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>angel <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> wh_increase_var<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">'rem'</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token punctuation">(</span>ballWidth <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> angel <span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> angel <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> wh_increase_var<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">'rem'</span>
      ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token punctuation">(</span>ballHeight <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> angel <span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> angel <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> wh_increase_var<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">'rem'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 小球运动轨迹函数</span>
  <span class="token keyword">function</span> <span class="token function">drawFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> angel
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dBallLayout<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> ballItem <span class="token operator">=</span> dBallLayout<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
      <span class="token comment">//转化角度为弧度制</span>
      angel <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>path_angel <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span>
      <span class="token comment">// 更新小球的宽高</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span> angel <span class="token operator">&lt;=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token punctuation">(</span>ballWidth <span class="token operator">+</span> <span class="token punctuation">(</span>angel <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>angel <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> wh_increase_var<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">'rem'</span>
        ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token punctuation">(</span>ballHeight <span class="token operator">+</span> <span class="token punctuation">(</span>angel <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>angel <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> wh_increase_var<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">'rem'</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token punctuation">(</span>ballWidth <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> angel <span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> angel <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> wh_increase_var<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">'rem'</span>
        ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token punctuation">(</span>ballHeight <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> angel <span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> angel <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> wh_increase_var<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">'rem'</span>
      <span class="token punctuation">}</span>
      <span class="token comment">//更新小球横坐标 Math.cos(0) =&gt; 1; Math.cos(Math.PI) =&gt; -1</span>
      ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token punctuation">(</span>path_length <span class="token operator">*</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>angel<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">&quot;rem&quot;</span>
      <span class="token comment">//更新小球纵坐标 Math.sin(Math.PI / 2) =&gt; 1</span>
      ballItem<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token punctuation">(</span>path_width <span class="token operator">*</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>angel<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">&quot;rem&quot;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//根据增量更新角度, 最大角度358度</span>
    path_angel <span class="token operator">=</span> <span class="token punctuation">(</span>path_angel <span class="token operator">+</span> angel_increase<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">360</span>
    <span class="token comment">// 获取到数据, 让球停下来</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> team <span class="token operator">!==</span> <span class="token number">2</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span> angel_increase <span class="token operator">&lt;=</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        angel_increase <span class="token operator">=</span> <span class="token number">.7</span>
        <span class="token keyword">const</span> sixRadian <span class="token operator">=</span> angel<span class="token punctuation">;</span>  <span class="token comment">// 6号球的弧度位置(红球)</span>
        <span class="token keyword">let</span> startAngel<span class="token punctuation">,</span> targetAngel <span class="token operator">=</span> <span class="token number">180</span><span class="token punctuation">;</span>  <span class="token comment">// 最后要停下来的球的起始角度和目标角度</span>
        <span class="token keyword">const</span> sixRadian2Angel <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>sixRadian <span class="token operator">*</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">/</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">120</span>
        <span class="token comment">// 红黄球分开计算距离</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> team <span class="token operator">===</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
          startAngel <span class="token operator">=</span> sixRadian2Angel <span class="token operator">+</span> <span class="token number">60</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          startAngel <span class="token operator">=</span> sixRadian2Angel <span class="token operator">&gt;=</span> <span class="token number">60</span> <span class="token operator">?</span> sixRadian2Angel <span class="token operator">:</span> sixRadian2Angel <span class="token operator">+</span> <span class="token number">120</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> targetAngel <span class="token operator">-</span> startAngel <span class="token operator">&lt;=</span> angel_increase <span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 移动到180度，收工</span>
          <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
          <span class="token comment">// 选中的战队</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">您属于</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>team <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">'红'</span> <span class="token operator">:</span> <span class="token string">'黄'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">队</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        angel_increase <span class="token operator">-=</span>  <span class="token number">0.04</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  DOpenTeam<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 防止重复点击</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>throttle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    throttle <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token comment">// 开启动画</span>
    timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>drawFrame<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
    <span class="token comment">// 请求数据(定时器模拟)</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      team <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>team<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
    
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><!----></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/pages/code/饿了么Dialog组件二次封装.html" class="prev">
        饿了么Dialog组件二次封装
      </a></span> <span class="next"><a href="/pages/code/常用scss函数表.html">
        常用scss函数表
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.fa2fa8e2.js" defer></script><script src="/assets/js/2.86ccc841.js" defer></script><script src="/assets/js/36.ebee6c1f.js" defer></script>
  </body>
</html>
